!function(){"use strict";if(void 0===globalThis.autoAcceptAndAnalytics){class e{constructor(e=2e3){this.interval=e,this.isRunning=!1,this.monitorInterval=null,this.totalClicks=0,this.controlPanel=null,this.isDragging=!1,this.dragOffset={x:0,y:0},this.currentTab="main",this.loggedMessages=new Set,this.debugMode=!1,this.analytics={files:new Map,sessions:[],totalAccepts:0,sessionStart:new Date},this.roiTracking={totalTimeSaved:0,codeGenerationSessions:[],averageCompleteWorkflow:3e4,averageAutomatedWorkflow:100,currentWorkflowStart:null,currentSessionButtons:0,workflowSessions:[]},this.config={enableAcceptAll:!0,enableAccept:!0,enableRun:!0,enableRunCommand:!0,enableApply:!0,enableExecute:!0,enableResume:!0},this.loadFromStorage(),this.createControlPanel(),this.log("autoAcceptAndAnalytics initialized with file analytics and ROI tracking")}saveToStorage(){try{const e={analytics:{files:Array.from(this.analytics.files.entries()),sessions:this.analytics.sessions,totalAccepts:this.analytics.totalAccepts,sessionStart:this.analytics.sessionStart},roiTracking:this.roiTracking,config:this.config,totalClicks:this.totalClicks,savedAt:new Date};localStorage.setItem("cursor-auto-accept-data",JSON.stringify(e))}catch(e){console.warn("Failed to save to localStorage:",e)}}loadFromStorage(){try{const e=localStorage.getItem("cursor-auto-accept-data");if(e){const t=JSON.parse(e);t.analytics&&(this.analytics.files=new Map(t.analytics.files||[]),this.analytics.sessions=t.analytics.sessions||[],this.analytics.totalAccepts=t.analytics.totalAccepts||0,this.analytics.sessionStart=t.analytics.sessionStart?new Date(t.analytics.sessionStart):new Date),t.roiTracking&&(this.roiTracking={...this.roiTracking,...t.roiTracking}),t.config&&(this.config={...this.config,...t.config}),t.totalClicks&&(this.totalClicks=t.totalClicks),console.log("Data loaded from localStorage")}}catch(e){console.warn("Failed to load from localStorage:",e)}}clearStorage(){try{localStorage.removeItem("cursor-auto-accept-data"),console.log("Storage cleared"),this.analytics.files.clear(),this.analytics.sessions=[],this.analytics.totalAccepts=0,this.analytics.sessionStart=new Date,this.roiTracking.totalTimeSaved=0,this.totalClicks=0,this.updateAnalyticsContent(),this.updateMainFooter(),this.updatePanelStatus(),this.logToPanel("🗑️ All data cleared (storage + session)","warning")}catch(e){console.warn("Failed to clear localStorage:",e)}}validateData(){console.log("=== DATA VALIDATION ==="),console.log("Session Info:"),console.log(`  Session Start: ${this.analytics.sessionStart}`),console.log(`  Total Accepts: ${this.analytics.totalAccepts}`),console.log(`  Total Clicks: ${this.totalClicks}`),console.log(`  Total Time Saved: ${this.formatTimeDuration(this.roiTracking.totalTimeSaved)}`),console.log("\nFiles Tracked:"),this.analytics.files.forEach(((e,t)=>{console.log(`  ${t}:`),console.log(`    Accept Count: ${e.acceptCount}`),console.log(`    Total Added: +${e.totalAdded}`),console.log(`    Total Deleted: -${e.totalDeleted}`),console.log(`    Last Accepted: ${e.lastAccepted}`)})),console.log("\nRecent Sessions:"),this.analytics.sessions.slice(-5).forEach(((e,t)=>{console.log(`  ${t+1}. ${e.filename} (+${e.addedLines}/-${e.deletedLines}) [${e.buttonType}] at ${e.timestamp}`)})),console.log("\nLocalStorage Check:");try{const e=localStorage.getItem("cursor-auto-accept-data");if(e){const t=JSON.parse(e);console.log("  Storage exists, saved at:",t.savedAt),console.log("  Storage analytics total accepts:",t.analytics?.totalAccepts||0),console.log("  Storage total clicks:",t.totalClicks||0)}else console.log("  No data in localStorage")}catch(e){console.log("  Error reading localStorage:",e)}return console.log("=== END VALIDATION ==="),{currentSession:{totalAccepts:this.analytics.totalAccepts,totalClicks:this.totalClicks,timeSaved:this.roiTracking.totalTimeSaved,filesCount:this.analytics.files.size},isDataConsistent:this.analytics.totalAccepts===this.analytics.sessions.length}}toggleDebug(){return this.debugMode=!this.debugMode,console.log("Debug mode "+(this.debugMode?"enabled":"disabled")),this.logToPanel("Debug mode "+(this.debugMode?"ON":"OFF"),"info"),this.debugMode}calibrateWorkflowTimes(e,t=100){const n=this.roiTracking.averageCompleteWorkflow,a=this.roiTracking.averageAutomatedWorkflow;return this.roiTracking.averageCompleteWorkflow=1e3*e,this.roiTracking.averageAutomatedWorkflow=t,console.log("Workflow times updated:"),console.log(`  Manual: ${n/1e3}s → ${e}s`),console.log(`  Automated: ${a}ms → ${t}ms`),this.roiTracking.totalTimeSaved=0,this.roiTracking.workflowSessions.forEach((e=>{const t=this.roiTracking.averageCompleteWorkflow-this.roiTracking.averageAutomatedWorkflow;this.roiTracking.totalTimeSaved+=t,e.timeSaved=t})),this.saveToStorage(),this.updateAnalyticsContent(),this.updateMainFooter(),this.logToPanel(`Workflow calibrated: ${e}s manual`,"info"),{manual:e,automated:t}}startCodeGenSession(){this.roiTracking.currentSessionStart=new Date,this.roiTracking.currentSessionButtons=0}endCodeGenSession(){if(this.roiTracking.currentSessionStart){const e=new Date-this.roiTracking.currentSessionStart;this.roiTracking.codeGenerationSessions.push({start:this.roiTracking.currentSessionStart,duration:e,buttonsClicked:this.roiTracking.currentSessionButtons,timeSaved:this.roiTracking.currentSessionButtons*this.roiTracking.manualClickTime}),this.roiTracking.currentSessionStart=null}}calculateTimeSaved(e){const t={"accept all":this.roiTracking.averageCompleteWorkflow+5e3,accept:this.roiTracking.averageCompleteWorkflow,run:this.roiTracking.averageCompleteWorkflow+2e3,execute:this.roiTracking.averageCompleteWorkflow+2e3,apply:this.roiTracking.averageCompleteWorkflow,resume:this.roiTracking.averageCompleteWorkflow+3e3}[e.toLowerCase()]||this.roiTracking.averageCompleteWorkflow,n=this.roiTracking.averageAutomatedWorkflow,a=t-n;return this.roiTracking.totalTimeSaved+=a,this.roiTracking.currentSessionButtons++,this.roiTracking.workflowSessions.push({timestamp:new Date,buttonType:e,manualTime:t,automatedTime:n,timeSaved:a}),this.saveToStorage(),a}formatTimeDuration(e){if(!e||isNaN(e)||e<=0)return"0s";const t=Math.floor(e/1e3),n=Math.floor(t/3600),a=Math.floor(t%3600/60),o=t%60;return n>0?`${n}h ${a}m ${o}s`:a>0?`${a}m ${o}s`:`${o}s`}extractFileInfo(e){try{this.debugMode&&(this.log("=== DEBUG: extractFileInfo called ==="),this.log(`Button text: "${e.textContent.trim()}"`),this.log(`Button classes: ${e.className}`));const t=document.querySelector("div.conversations");if(!t)return this.debugMode&&this.log("DEBUG: No conversations div found"),null;const n=Array.from(t.querySelectorAll("[data-message-index]")).sort(((e,t)=>{const n=parseInt(e.getAttribute("data-message-index"));return parseInt(t.getAttribute("data-message-index"))-n}));if(this.debugMode&&(this.log(`DEBUG: Found ${n.length} message bubbles`),n.length>0)){const e=n[0].getAttribute("data-message-index");this.log(`DEBUG: Latest message index: ${e}`)}for(let e=0;e<Math.min(5,n.length);e++){const t=n[e],a=t.getAttribute("data-message-index");this.debugMode&&this.log(`DEBUG: Checking message ${a}`);const o=t.querySelectorAll(".composer-code-block-container, .composer-tool-former-message, .composer-diff-block");this.debugMode&&o.length>0&&this.log(`DEBUG: Found ${o.length} code blocks in message ${a}`);for(const e of o){const t=this.extractFileInfoFromBlock(e);if(t)return this.debugMode&&this.log(`DEBUG: Successfully extracted file info: ${JSON.stringify(t)}`),t}}return this.debugMode&&this.log("DEBUG: No file info found in recent messages, trying fallback method"),this.extractFileInfoFallback(e)}catch(e){return this.log(`Error extracting file info: ${e.message}`),this.debugMode&&this.log(`DEBUG: Error stack: ${e.stack}`),null}}extractFileInfoFromBlock(e){try{this.debugMode&&this.log(`DEBUG: Analyzing block with classes: ${e.className}`);let t=null,n=0,a=0;const o=e.querySelector('.composer-code-block-filename span[style*="direction: ltr"]')||e.querySelector(".composer-code-block-filename span")||e.querySelector(".composer-code-block-filename");if(o&&(t=o.textContent.trim(),this.debugMode&&this.log(`DEBUG: Found filename via span: "${t}"`)),!t){const n=e.querySelectorAll("span");for(const e of n){const n=e.textContent.trim();if(n&&n.includes(".")&&n.length<100&&!n.includes(" ")){const e=n.split(".");if(e.length>=2&&e[e.length-1].length<=10){t=n,this.debugMode&&this.log(`DEBUG: Found filename via pattern matching: "${t}"`);break}}}}const s=e.querySelectorAll('.composer-code-block-status span, span[style*="color"]');this.debugMode&&this.log(`DEBUG: Found ${s.length} status elements`);for(const e of s){const t=e.textContent.trim();this.debugMode&&this.log(`DEBUG: Status text: "${t}"`);const o=t.match(/\+(\d+)/),s=t.match(/-(\d+)/);o&&(n=Math.max(n,parseInt(o[1])),this.debugMode&&this.log(`DEBUG: Found added lines: ${n}`)),s&&(a=Math.max(a,parseInt(s[1])),this.debugMode&&this.log(`DEBUG: Found deleted lines: ${a}`))}if(t){const e={filename:t,addedLines:n||0,deletedLines:a||0,timestamp:new Date};return this.debugMode&&this.log(`DEBUG: Created file info object: ${JSON.stringify(e)}`),e}return this.debugMode&&this.log("DEBUG: No filename found in this block"),null}catch(e){return this.debugMode&&this.log(`DEBUG: Error in extractFileInfoFromBlock: ${e.message}`),null}}extractFileInfoFallback(e){try{this.debugMode&&this.log("DEBUG: Using fallback extraction method");let t=e.closest(".composer-code-block-container");if(!t){let n=e.parentElement,a=0;for(;n&&a<10&&(t=n.querySelector(".composer-code-block-container"),!t);)n=n.parentElement,a++}if(!t)return this.debugMode&&this.log("DEBUG: No container found in fallback method"),null;let n=t.querySelector('.composer-code-block-filename span[style*="direction: ltr"]');n||(n=t.querySelector(".composer-code-block-filename span")),n||(n=t.querySelector(".composer-code-block-filename"));const a=n?n.textContent.trim():"Unknown",o=t.querySelector(".composer-code-block-status span");let s=0,i=0;if(o){const e=o.textContent,t=e.match(/\+(\d+)/),n=e.match(/-(\d+)/);t&&(s=parseInt(t[1])),n&&(i=parseInt(n[1])),this.debugMode&&this.log(`DEBUG: Fallback extracted - File: ${a}, Status: "${e}", +${s}/-${i}`)}return{filename:a,addedLines:s||0,deletedLines:i||0,timestamp:new Date}}catch(e){return this.debugMode&&this.log(`DEBUG: Error in fallback method: ${e.message}`),null}}trackFileAcceptance(e,t="accept"){if(!e||!e.filename)return;const{filename:n,addedLines:a,deletedLines:o,timestamp:s}=e,i=this.normalizeButtonType(t),l=this.calculateTimeSaved(i),c=isNaN(a)?0:a,r=isNaN(o)?0:o,d=isNaN(l)?0:l;if(this.analytics.files.has(n)){const e=this.analytics.files.get(n);e.acceptCount++,e.lastAccepted=s,e.totalAdded+=c,e.totalDeleted+=r,e.buttonTypes||(e.buttonTypes={}),e.buttonTypes[i]=(e.buttonTypes[i]||0)+1}else this.analytics.files.set(n,{acceptCount:1,firstAccepted:s,lastAccepted:s,totalAdded:c,totalDeleted:r,buttonTypes:{[i]:1}});this.analytics.sessions.push({filename:n,addedLines:c,deletedLines:r,timestamp:s,buttonType:i,timeSaved:d}),this.analytics.buttonTypeCounts||(this.analytics.buttonTypeCounts={}),this.analytics.buttonTypeCounts[i]=(this.analytics.buttonTypeCounts[i]||0)+1,this.analytics.totalAccepts++,this.logToPanel(`📁 ${n} (+${c}/-${r}) [${i}] [saved ${this.formatTimeDuration(d)}]`,"file"),this.log(`File accepted: ${n} (+${c}/-${r}) - Button: ${i} - Time saved: ${this.formatTimeDuration(d)}`),"analytics"!==this.currentTab&&"roi"!==this.currentTab||this.updateAnalyticsContent(),this.updateMainFooter(),this.saveToStorage()}normalizeButtonType(e){if(!e)return"unknown";const t=e.toLowerCase().trim();return t.includes("accept all")?"accept-all":t.includes("accept")?"accept":t.includes("run command")?"run-command":t.includes("run")?"run":t.includes("apply")?"apply":t.includes("execute")?"execute":t.includes("resume")?"resume-conversation":t}createControlPanel(){if(this.controlPanel)return;this.controlPanel=document.createElement("div"),this.controlPanel.id="auto-accept-control-panel";const e=document.createElement("div");e.className="aa-header";const t=document.createElement("div");t.className="aa-tabs";const n=document.createElement("button");n.className="aa-tab aa-tab-active",n.textContent="Main",n.onclick=()=>this.switchTab("main");const a=document.createElement("button");a.className="aa-tab",a.textContent="Analytics",a.onclick=()=>this.switchTab("analytics");const o=document.createElement("button");o.className="aa-tab",o.textContent="ROI",o.onclick=()=>this.switchTab("roi"),t.appendChild(n),t.appendChild(a),t.appendChild(o);const s=document.createElement("div");s.className="aa-header-controls";const i=document.createElement("button");i.className="aa-minimize",i.title="Minimize",i.textContent="−";const l=document.createElement("button");l.className="aa-close",l.title="Close",l.textContent="×",s.appendChild(i),s.appendChild(l),e.appendChild(t),e.appendChild(s);const c=document.createElement("div");c.className="aa-content aa-main-content";const r=document.createElement("div");r.className="aa-status";const d=document.createElement("span");d.className="aa-status-text",d.textContent="Stopped";const h=document.createElement("span");h.className="aa-clicks",h.textContent="0 clicks",r.appendChild(d),r.appendChild(h);const p=document.createElement("div");p.className="aa-controls";const u=document.createElement("button");u.className="aa-btn aa-start",u.textContent="Start";const m=document.createElement("button");m.className="aa-btn aa-stop",m.textContent="Stop",m.disabled=!0;const g=document.createElement("button");g.className="aa-btn aa-config",g.textContent="Config",p.appendChild(u),p.appendChild(m),p.appendChild(g);const f=document.createElement("div");f.className="aa-config-panel",f.style.display="none";[{id:"aa-accept-all",text:"Accept All",checked:!0},{id:"aa-accept",text:"Accept",checked:!0},{id:"aa-run",text:"Run",checked:!0},{id:"aa-apply",text:"Apply",checked:!0},{id:"aa-resume",text:"Resume Conversation",checked:!0}].forEach((e=>{const t=document.createElement("label"),n=document.createElement("input");n.type="checkbox",n.id=e.id,n.checked=e.checked,t.appendChild(n),t.appendChild(document.createTextNode(" "+e.text)),f.appendChild(t)}));const b=document.createElement("div");b.className="aa-log";const y=document.createElement("div");y.className="aa-roi-footer";const C=document.createElement("div");C.className="aa-credits";const x=document.createElement("small");x.textContent="Created by ";const k=document.createElement("a");k.href="https://linkedin.com/in/ivalsaraj",k.target="_blank",k.textContent="@ivalsaraj",x.appendChild(k),C.appendChild(x),c.appendChild(r),c.appendChild(p),c.appendChild(f),c.appendChild(b),c.appendChild(y),c.appendChild(C);const T=document.createElement("div");T.className="aa-content aa-analytics-content",T.style.display="none",this.controlPanel.appendChild(e),this.controlPanel.appendChild(c),this.controlPanel.appendChild(T),this.controlPanel.style.cssText="\n                    position: fixed;\n                    top: 100px;\n                    right: 20px;\n                    width: 280px;\n                    background: #1e1e1e;\n                    border: 1px solid #333;\n                    border-radius: 6px;\n                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\n                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n                    font-size: 12px;\n                    color: #ccc;\n                    z-index: 999999;\n                    user-select: none;\n                    max-height: 500px;\n                    display: flex;\n                    flex-direction: column;\n                ",this.addPanelStyles(),this.setupPanelEvents(),document.body.appendChild(this.controlPanel),this.updateAnalyticsContent(),this.updateMainFooter()}updateMainFooter(){const e=this.controlPanel?.querySelector(".aa-roi-footer");if(!e)return;for(;e.firstChild;)e.removeChild(e.firstChild);const t=this.roiTracking.totalTimeSaved||0,n=this.analytics.totalAccepts||0,a=(new Date,this.analytics.sessionStart,n*this.roiTracking.averageCompleteWorkflow),o=n*this.roiTracking.averageAutomatedWorkflow,s=a>0?(a-o)/a*100:0,i=document.createElement("div");i.className="aa-roi-footer-title",i.textContent="⚡ Workflow ROI";const l=document.createElement("div");l.className="aa-roi-footer-stats";const c=document.createElement("span");c.textContent=`Time Saved: ${this.formatTimeDuration(t)}`;const r=document.createElement("span");r.textContent=`Workflow Efficiency: ${s.toFixed(1)}%`,l.appendChild(c),l.appendChild(r),e.appendChild(i),e.appendChild(l)}switchTab(e){this.currentTab=e;this.controlPanel.querySelectorAll(".aa-tab").forEach((t=>{t.classList.remove("aa-tab-active"),t.textContent.toLowerCase()===e&&t.classList.add("aa-tab-active")}));const t=this.controlPanel.querySelector(".aa-main-content"),n=this.controlPanel.querySelector(".aa-analytics-content");"main"===e?(t.style.display="block",n.style.display="none"):("analytics"===e||"roi"===e)&&(t.style.display="none",n.style.display="block",this.updateAnalyticsContent())}updateAnalyticsContent(){const e=this.controlPanel.querySelector(".aa-analytics-content");e&&(e.textContent="","analytics"===this.currentTab?this.renderAnalyticsTab(e):"roi"===this.currentTab&&this.renderROITab(e))}renderAnalyticsTab(e){const t=new Date,n=Math.round((t-this.analytics.sessionStart)/1e3/60);let a=this.analytics.files.size,o=0,s=0;this.analytics.files.forEach((e=>{o+=e.totalAdded,s+=e.totalDeleted}));const i=document.createElement("div");i.className="aa-analytics-summary";const l=document.createElement("h4");l.textContent="📊 Session Analytics",i.appendChild(l);if([{label:"Session:",value:`${n}min`},{label:"Total Accepts:",value:`${this.analytics.totalAccepts}`},{label:"Files Modified:",value:`${a}`},{label:"Lines Added:",value:`+${o}`,class:"aa-stat-added"},{label:"Lines Deleted:",value:`-${s}`,class:"aa-stat-deleted"}].forEach((e=>{const t=document.createElement("div");t.className="aa-stat";const n=document.createElement("span");n.className="aa-stat-label",n.textContent=e.label;const a=document.createElement("span");a.className=`aa-stat-value ${e.class||""}`,a.textContent=e.value,t.appendChild(n),t.appendChild(a),i.appendChild(t)})),this.analytics.buttonTypeCounts&&Object.keys(this.analytics.buttonTypeCounts).length>0){const e=document.createElement("div");e.className="aa-button-types";const t=document.createElement("h5");t.textContent="🎯 Button Types",t.style.cssText="margin: 8px 0 4px 0; font-size: 11px; color: #ddd;",e.appendChild(t),Object.entries(this.analytics.buttonTypeCounts).forEach((([t,n])=>{const a=document.createElement("div");a.className="aa-stat aa-button-type-stat",a.style.cssText="font-size: 10px; padding: 2px 0;";const o=document.createElement("span");o.className="aa-stat-label",o.textContent=`${t}:`;const s=document.createElement("span");s.className="aa-stat-value",s.textContent=`${n}x`,s.style.color="accept"===t||"accept-all"===t?"#4CAF50":"run"===t||"run-command"===t?"#FF9800":"resume-conversation"===t?"#2196F3":"#9C27B0",a.appendChild(o),a.appendChild(s),e.appendChild(a)})),i.appendChild(e)}const c=document.createElement("div");c.className="aa-analytics-files";const r=document.createElement("h4");r.textContent="📁 File Activity",c.appendChild(r);const d=document.createElement("div");d.className="aa-files-list",this.renderFilesList(d),c.appendChild(d);const h=document.createElement("div");h.className="aa-analytics-actions";const p=document.createElement("button");p.className="aa-btn aa-btn-small",p.textContent="Export Data",p.onclick=()=>this.exportAnalytics();const u=document.createElement("button");u.className="aa-btn aa-btn-small",u.textContent="Clear Data",u.onclick=()=>this.clearAnalytics(),h.appendChild(p),h.appendChild(u);const m=document.createElement("div");m.className="aa-credits";const g=document.createElement("small");g.textContent="Created by ";const f=document.createElement("a");f.href="https://linkedin.com/in/ivalsaraj",f.target="_blank",f.textContent="@ivalsaraj",g.appendChild(f),m.appendChild(g),e.appendChild(i),e.appendChild(c),e.appendChild(h),e.appendChild(m)}renderROITab(e){const t=new Date-this.analytics.sessionStart,n=this.roiTracking.totalTimeSaved||0,a=this.analytics.totalAccepts||0,o=a>0?n/a:0,s=t>0?n/t*100:0,i=document.createElement("div");i.className="aa-roi-summary";const l=document.createElement("h4");l.textContent="⚡ Complete Workflow ROI",i.appendChild(l);const c=document.createElement("div");c.className="aa-roi-explanation",c.style.cssText="font-size: 10px; color: #888; margin-bottom: 8px; line-height: 1.3;",c.textContent="Measures complete AI workflow: User prompt → Cursor generation → Manual watching/clicking vs Auto-acceptance",i.appendChild(c);[{label:"Total Time Saved:",value:this.formatTimeDuration(n),class:"aa-roi-highlight"},{label:"Session Duration:",value:this.formatTimeDuration(t)},{label:"Avg. per Click:",value:this.formatTimeDuration(o)},{label:"Productivity Gain:",value:`${s.toFixed(1)}%`,class:"aa-roi-percentage"},{label:"Clicks Automated:",value:`${a}`}].forEach((e=>{const t=document.createElement("div");t.className="aa-stat";const n=document.createElement("span");n.className="aa-stat-label",n.textContent=e.label;const a=document.createElement("span");a.className=`aa-stat-value ${e.class||""}`,a.textContent=e.value,t.appendChild(n),t.appendChild(a),i.appendChild(t)}));const r=document.createElement("div");r.className="aa-roi-impact";const d=document.createElement("h4");d.textContent="📈 Impact Analysis",r.appendChild(d);const h=document.createElement("div");h.className="aa-roi-text";const p=288e5*(t>0?n/t:0);[{period:"Daily (8hrs)",saved:p},{period:"Weekly (5 days)",saved:5*p},{period:"Monthly (22 days)",saved:22*p}].forEach((e=>{const t=document.createElement("div");t.className="aa-roi-scenario",t.textContent=`${e.period}: ${this.formatTimeDuration(e.saved)} saved`,h.appendChild(t)})),r.appendChild(h);const u=document.createElement("div");u.className="aa-roi-comparison";const m=document.createElement("h4");m.textContent="🔄 Complete Workflow Comparison",u.appendChild(m);const g=document.createElement("div");g.className="aa-workflow-breakdown",g.style.cssText="font-size: 10px; color: #888; margin-bottom: 8px; line-height: 1.3;";const f=document.createElement("div");f.textContent="Manual: Watch generation + Find button + Click + Context switch (~30s)",g.appendChild(f);const b=document.createElement("div");b.textContent="Automated: Instant detection and clicking while you code (~0.1s)",g.appendChild(b),u.appendChild(g);const y=a*this.roiTracking.averageCompleteWorkflow,C=a*this.roiTracking.averageAutomatedWorkflow;[{label:"Manual Workflow Time:",value:this.formatTimeDuration(y),class:"aa-roi-manual"},{label:"Automated Workflow Time:",value:this.formatTimeDuration(C),class:"aa-roi-auto"},{label:"Workflow Efficiency:",value:`${y>0?((y-C)/y*100).toFixed(1):"0.0"}%`,class:"aa-roi-highlight"}].forEach((e=>{const t=document.createElement("div");t.className="aa-stat";const n=document.createElement("span");n.className="aa-stat-label",n.textContent=e.label;const a=document.createElement("span");a.className=`aa-stat-value ${e.class||""}`,a.textContent=e.value,t.appendChild(n),t.appendChild(a),u.appendChild(t)}));const x=document.createElement("div");x.className="aa-credits";const k=document.createElement("small");k.textContent="Created by ";const T=document.createElement("a");T.href="https://linkedin.com/in/ivalsaraj",T.target="_blank",T.textContent="@ivalsaraj",k.appendChild(T),x.appendChild(k),e.appendChild(i),e.appendChild(r),e.appendChild(u),e.appendChild(x)}renderFilesList(e){if(0===this.analytics.files.size){const t=document.createElement("div");return t.className="aa-no-files",t.textContent="No files modified yet",void e.appendChild(t)}Array.from(this.analytics.files.entries()).sort(((e,t)=>t[1].lastAccepted-e[1].lastAccepted)).forEach((([t,n])=>{const a=this.getTimeAgo(n.lastAccepted),o=document.createElement("div");o.className="aa-file-item";const s=document.createElement("div");s.className="aa-file-name",s.textContent=t;const i=document.createElement("div");i.className="aa-file-stats";const l=document.createElement("span");l.className="aa-file-count",l.textContent=`${n.acceptCount}x`;const c=document.createElement("span");c.className="aa-file-changes",c.textContent=`+${n.totalAdded}/-${n.totalDeleted}`;const r=document.createElement("span");r.className="aa-file-time",r.textContent=a,i.appendChild(l),i.appendChild(c),i.appendChild(r),o.appendChild(s),o.appendChild(i),e.appendChild(o)}))}getTimeAgo(e){const t=new Date,n=Math.round((t-e)/1e3);return n<60?`${n}s ago`:n<3600?`${Math.round(n/60)}m ago`:n<86400?`${Math.round(n/3600)}h ago`:`${Math.round(n/86400)}d ago`}exportAnalytics(){const e={session:{start:this.analytics.sessionStart,duration:new Date-this.analytics.sessionStart,totalAccepts:this.analytics.totalAccepts},files:Object.fromEntries(this.analytics.files),sessions:this.analytics.sessions,config:this.config,exportedAt:new Date},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download=`cursor-auto-accept-analytics-${(new Date).toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(n),this.logToPanel("📥 Analytics exported","info")}clearAnalytics(){confirm("Clear all analytics data? This cannot be undone.")&&(this.analytics.files.clear(),this.analytics.sessions=[],this.analytics.totalAccepts=0,this.analytics.sessionStart=new Date,this.updateAnalyticsContent(),this.logToPanel("🗑️ Analytics cleared","warning"))}addPanelStyles(){if(document.getElementById("auto-accept-styles"))return;const e=document.createElement("style");e.id="auto-accept-styles",e.textContent='\n                    .aa-header {\n                        background: #2d2d2d;\n                        padding: 6px 10px;\n                        border-radius: 5px 5px 0 0;\n                        cursor: move;\n                        display: flex;\n                        justify-content: space-between;\n                        align-items: center;\n                        border-bottom: 1px solid #333;\n                    }\n                    \n                    .aa-tabs {\n                        display: flex;\n                        gap: 4px;\n                    }\n                    \n                    .aa-tab {\n                        background: #444;\n                        border: none;\n                        color: #ccc;\n                        font-size: 11px;\n                        cursor: pointer;\n                        padding: 4px 8px;\n                        border-radius: 3px;\n                        transition: all 0.2s;\n                    }\n                    \n                    .aa-tab:hover {\n                        background: #555;\n                    }\n                    \n                    .aa-tab-active {\n                        background: #0d7377 !important;\n                        color: white !important;\n                    }\n                    \n                    .aa-header-controls {\n                        display: flex;\n                        gap: 4px;\n                    }\n                    \n                    .aa-title {\n                        font-weight: 500;\n                        color: #fff;\n                        font-size: 12px;\n                    }\n                    .aa-minimize, .aa-close {\n                        background: #444;\n                        border: none;\n                        color: #ccc;\n                        font-size: 12px;\n                        font-weight: bold;\n                        cursor: pointer;\n                        padding: 2px 5px;\n                        border-radius: 2px;\n                        line-height: 1;\n                        width: 16px;\n                        height: 16px;\n                        display: flex;\n                        align-items: center;\n                        justify-content: center;\n                    }\n                    .aa-minimize:hover, .aa-close:hover {\n                        background: #555;\n                    }\n                    .aa-close:hover {\n                        background: #dc3545;\n                        color: white;\n                    }\n                    .aa-content {\n                        padding: 12px;\n                        overflow-y: auto;\n                        flex: 1;\n                    }\n                    .aa-status {\n                        display: flex;\n                        justify-content: space-between;\n                        margin-bottom: 10px;\n                        padding: 6px 8px;\n                        background: #252525;\n                        border-radius: 4px;\n                        font-size: 11px;\n                    }\n                    .aa-status-text.running {\n                        color: #4CAF50;\n                        font-weight: 500;\n                    }\n                    .aa-status-text.stopped {\n                        color: #f44336;\n                    }\n                    .aa-clicks {\n                        color: #888;\n                    }\n                    .aa-controls {\n                        display: flex;\n                        gap: 6px;\n                        margin-bottom: 10px;\n                    }\n                    .aa-btn {\n                        flex: 1;\n                        padding: 6px 12px;\n                        border: none;\n                        border-radius: 4px;\n                        cursor: pointer;\n                        font-size: 11px;\n                        font-weight: 500;\n                        transition: all 0.2s;\n                    }\n                    .aa-btn-small {\n                        flex: none;\n                        padding: 4px 8px;\n                        font-size: 10px;\n                    }\n                    .aa-start {\n                        background: #4CAF50;\n                        color: white;\n                    }\n                    .aa-start:hover:not(:disabled) {\n                        background: #45a049;\n                    }\n                    .aa-stop {\n                        background: #f44336;\n                        color: white;\n                    }\n                    .aa-stop:hover:not(:disabled) {\n                        background: #da190b;\n                    }\n                    .aa-config {\n                        background: #2196F3;\n                        color: white;\n                    }\n                    .aa-config:hover:not(:disabled) {\n                        background: #1976D2;\n                    }\n                    .aa-btn:disabled {\n                        opacity: 0.5;\n                        cursor: not-allowed;\n                    }\n                    .aa-config-panel {\n                        background: #252525;\n                        border-radius: 4px;\n                        padding: 8px;\n                        margin-bottom: 10px;\n                    }\n                    .aa-config-panel label {\n                        display: block;\n                        margin-bottom: 4px;\n                        font-size: 11px;\n                        cursor: pointer;\n                    }\n                    .aa-config-panel input[type="checkbox"] {\n                        margin-right: 6px;\n                    }\n                    .aa-log {\n                        background: #252525;\n                        border-radius: 4px;\n                        padding: 8px;\n                        height: 120px;\n                        overflow-y: auto;\n                        font-size: 10px;\n                        line-height: 1.3;\n                    }\n                    .aa-log-entry {\n                        margin-bottom: 2px;\n                        padding: 2px 4px;\n                        border-radius: 2px;\n                    }\n                    .aa-log-entry.info {\n                        color: #4CAF50;\n                    }\n                    .aa-log-entry.warning {\n                        color: #FF9800;\n                    }\n                    .aa-log-entry.error {\n                        color: #f44336;\n                    }\n                    .aa-log-entry.file {\n                        color: #2196F3;\n                        background: rgba(33, 150, 243, 0.1);\n                    }\n                    \n                    /* Analytics Styles */\n                    .aa-analytics-summary {\n                        background: #252525;\n                        border-radius: 4px;\n                        padding: 8px;\n                        margin-bottom: 10px;\n                    }\n                    \n                    .aa-analytics-summary h4 {\n                        margin: 0 0 8px 0;\n                        font-size: 12px;\n                        color: #fff;\n                    }\n                    \n                    .aa-stat {\n                        display: flex;\n                        justify-content: space-between;\n                        margin-bottom: 4px;\n                        font-size: 11px;\n                    }\n                    \n                    .aa-stat-label {\n                        color: #888;\n                    }\n                    \n                    .aa-stat-value {\n                        color: #fff;\n                        font-weight: 500;\n                    }\n                    \n                    .aa-stat-added {\n                        color: #4CAF50;\n                    }\n                    \n                    .aa-stat-deleted {\n                        color: #f44336;\n                    }\n                    \n                    .aa-analytics-files {\n                        background: #252525;\n                        border-radius: 4px;\n                        padding: 8px;\n                        margin-bottom: 10px;\n                    }\n                    \n                    .aa-analytics-files h4 {\n                        margin: 0 0 8px 0;\n                        font-size: 12px;\n                        color: #fff;\n                    }\n                    \n                    .aa-files-list {\n                        max-height: 150px;\n                        overflow-y: auto;\n                    }\n                    \n                    .aa-file-item {\n                        padding: 4px 0;\n                        border-bottom: 1px solid #333;\n                    }\n                    \n                    .aa-file-item:last-child {\n                        border-bottom: none;\n                    }\n                    \n                    .aa-file-name {\n                        font-size: 11px;\n                        color: #fff;\n                        font-weight: 500;\n                        margin-bottom: 2px;\n                        word-break: break-all;\n                    }\n                    \n                    .aa-file-stats {\n                        display: flex;\n                        gap: 8px;\n                        font-size: 10px;\n                        color: #888;\n                    }\n                    \n                    .aa-file-count {\n                        background: #444;\n                        padding: 1px 4px;\n                        border-radius: 2px;\n                        color: #ccc;\n                    }\n                    \n                    .aa-file-changes {\n                        color: #2196F3;\n                    }\n                    \n                    .aa-file-time {\n                        margin-left: auto;\n                    }\n                    \n                    .aa-no-files {\n                        color: #888;\n                        font-size: 11px;\n                        text-align: center;\n                        padding: 20px;\n                    }\n                    \n                    .aa-analytics-actions {\n                        display: flex;\n                        gap: 6px;\n                        margin-bottom: 10px;\n                    }\n                    \n                    .aa-analytics-actions .aa-btn {\n                        background: #444;\n                        color: #ccc;\n                    }\n                    \n                    .aa-analytics-actions .aa-btn:hover {\n                        background: #555;\n                    }\n                    \n                    .aa-credits {\n                        text-align: center;\n                        padding: 8px;\n                        border-top: 1px solid #333;\n                        color: #666;\n                    }\n                    \n                    .aa-credits a {\n                        color: #2196F3;\n                        text-decoration: none;\n                    }\n                    \n                    .aa-credits a:hover {\n                        text-decoration: underline;\n                    }\n                    \n                    /* ROI Tab Styles */\n                    .aa-roi-summary, .aa-roi-impact, .aa-roi-comparison {\n                        margin-bottom: 12px;\n                        padding: 8px;\n                        background: #333;\n                        border-radius: 4px;\n                    }\n                    \n                    .aa-roi-highlight {\n                        color: #4CAF50 !important;\n                        font-weight: 600;\n                    }\n                    \n                    .aa-roi-percentage {\n                        color: #2196F3 !important;\n                        font-weight: 600;\n                    }\n                    \n                    .aa-roi-manual {\n                        color: #FF9800 !important;\n                    }\n                    \n                    .aa-roi-auto {\n                        color: #4CAF50 !important;\n                    }\n                    \n                    .aa-roi-text {\n                        margin-top: 8px;\n                    }\n                    \n                    .aa-roi-scenario {\n                        margin: 4px 0;\n                        padding: 4px;\n                        background: #444;\n                        border-radius: 3px;\n                        font-size: 11px;\n                        color: #ccc;\n                    }\n                    \n                    /* ROI Footer Styles (for main tab) */\n                    .aa-roi-footer {\n                        margin-top: 8px;\n                        padding: 6px 8px;\n                        background: #2d2d2d;\n                        border-radius: 4px;\n                        border-top: 1px solid #444;\n                    }\n                    \n                    .aa-roi-footer-title {\n                        font-size: 10px;\n                        color: #fff;\n                        font-weight: 600;\n                        margin-bottom: 4px;\n                    }\n                    \n                    .aa-roi-footer-stats {\n                        display: flex;\n                        justify-content: space-between;\n                        font-size: 9px;\n                        color: #888;\n                    }\n                    \n                    .aa-roi-footer-stats span {\n                        color: #4CAF50;\n                    }\n                    \n                    /* Minimize functionality */\n                    #auto-accept-control-panel.aa-minimized .aa-content {\n                        display: none;\n                    }\n                    \n                    #auto-accept-control-panel.aa-minimized {\n                        height: auto;\n                        max-height: none;\n                    }\n                ',document.head.appendChild(e)}setupPanelEvents(){const e=this.controlPanel.querySelector(".aa-header"),t=this.controlPanel.querySelector(".aa-minimize"),n=this.controlPanel.querySelector(".aa-close"),a=this.controlPanel.querySelector(".aa-start"),o=this.controlPanel.querySelector(".aa-stop"),s=this.controlPanel.querySelector(".aa-config"),i=this.controlPanel.querySelector(".aa-config-panel");e.addEventListener("mousedown",(e=>{if(e.target===t||e.target===n)return;this.isDragging=!0;const a=this.controlPanel.getBoundingClientRect();this.dragOffset.x=e.clientX-a.left,this.dragOffset.y=e.clientY-a.top,e.preventDefault()})),document.addEventListener("mousemove",(e=>{if(!this.isDragging)return;const t=e.clientX-this.dragOffset.x,n=e.clientY-this.dragOffset.y;this.controlPanel.style.left=Math.max(0,Math.min(window.innerWidth-this.controlPanel.offsetWidth,t))+"px",this.controlPanel.style.top=Math.max(0,Math.min(window.innerHeight-this.controlPanel.offsetHeight,n))+"px",this.controlPanel.style.right="auto"})),document.addEventListener("mouseup",(()=>{this.isDragging=!1})),t.addEventListener("click",(()=>{this.controlPanel.classList.toggle("aa-minimized")})),n.addEventListener("click",(()=>{this.hideControlPanel()})),a.addEventListener("click",(()=>{this.start()})),o.addEventListener("click",(()=>{this.stop()})),s.addEventListener("click",(()=>{i.style.display="none"===i.style.display?"block":"none"}));this.controlPanel.querySelectorAll('.aa-config-panel input[type="checkbox"]').forEach((e=>{e.addEventListener("change",(()=>{const t={"aa-accept-all":"enableAcceptAll","aa-accept":"enableAccept","aa-run":"enableRun","aa-apply":"enableApply","aa-resume":"enableResume"}[e.id];t&&(this.config[t]=e.checked,this.config.enableRunCommand=this.config.enableRun,this.config.enableExecute=this.config.enableApply)}))}))}updatePanelStatus(){if(!this.controlPanel)return;const e=this.controlPanel.querySelector(".aa-status-text"),t=this.controlPanel.querySelector(".aa-clicks"),n=this.controlPanel.querySelector(".aa-start"),a=this.controlPanel.querySelector(".aa-stop");this.isRunning?(e.textContent="Running",e.className="aa-status-text running",n.disabled=!0,a.disabled=!1):(e.textContent="Stopped",e.className="aa-status-text stopped",n.disabled=!1,a.disabled=!0),t.textContent=`${this.totalClicks} clicks`}logToPanel(e,t="info"){if(!this.controlPanel)return;const n=`${t}:${e}`;Date.now();if(this.loggedMessages.has(n))return;this.loggedMessages.add(n),setTimeout((()=>this.loggedMessages.delete(n)),2e3);const a=this.controlPanel.querySelector(".aa-log"),o=document.createElement("div");for(o.className=`aa-log-entry ${t}`,o.textContent=`${(new Date).toLocaleTimeString()}: ${e}`,a.appendChild(o),a.scrollTop=a.scrollHeight;a.children.length>20;)a.removeChild(a.firstChild)}showControlPanel(){this.controlPanel||this.createControlPanel(),this.controlPanel.style.display="block"}hideControlPanel(){this.controlPanel&&(this.controlPanel.style.display="none")}log(e){const t=`[AutoAccept] ${(new Date).toISOString()} - ${e}`;console.log(t),this.logToPanel(e,"info")}findAcceptButtons(){const e=[],t=document.querySelector("div.full-input-box");if(!t)return this.log("Input box not found"),e;let n=t.previousElementSibling,a=0;for(;n&&a<5;){const t=this.findAcceptInElement(n);e.push(...t),n=n.previousElementSibling,a++}if(this.config.enableResume){const t=this.findResumeLinks();e.push(...t)}return e}findAcceptInElement(e){const t=[],n=['div[class*="button"]',"button","div[onclick]",'div[style*="cursor: pointer"]','div[style*="cursor:pointer"]','[class*="anysphere"]','[class*="cursor-button"]','[class*="text-button"]','[class*="primary-button"]','[class*="secondary-button"]'];for(const a of n){const n=e.querySelectorAll(a);for(const e of n)this.isAcceptButton(e)&&t.push(e)}return this.isAcceptButton(e)&&t.push(e),t}isAcceptButton(e){if(!e||!e.textContent)return!1;if(this.config.enableResume&&this.isResumeLink(e))return!0;const t=e.textContent.toLowerCase().trim();if(![{pattern:"accept all",enabled:this.config.enableAcceptAll},{pattern:"accept",enabled:this.config.enableAccept},{pattern:"run command",enabled:this.config.enableRunCommand},{pattern:"run",enabled:this.config.enableRun},{pattern:"apply",enabled:this.config.enableApply},{pattern:"execute",enabled:this.config.enableExecute},{pattern:"resume",enabled:this.config.enableResume}].some((({pattern:e,enabled:n})=>n&&t.includes(e))))return!1;const n=this.isElementVisible(e),a=this.isElementClickable(e);return n&&a}isElementVisible(e){const t=window.getComputedStyle(e),n=e.getBoundingClientRect();return"none"!==t.display&&"hidden"!==t.visibility&&parseFloat(t.opacity)>.1&&n.width>0&&n.height>0}isElementClickable(e){return"none"!==window.getComputedStyle(e).pointerEvents&&!e.disabled&&!e.hasAttribute("disabled")}clickElement(e){try{const t=e.textContent.trim().toLowerCase(),n=this.isResumeLink(e);this.debugMode&&(this.log("=== DEBUG: clickElement called ==="),this.log(`Button text: "${t}"`),this.log(`Is Resume Link: ${n}`),this.log(`Element classes: ${e.className}`),this.log(`Element tag: ${e.tagName}`));let a=null;n||(a=this.extractFileInfo(e),this.debugMode&&this.log(`DEBUG: File info extraction result: ${a?JSON.stringify(a):"null"}`));const o=e.getBoundingClientRect(),s=o.left+o.width/2,i=o.top+o.height/2;this.debugMode&&this.log(`DEBUG: Element position: x=${s}, y=${i}`),e.click();const l=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,clientX:s,clientY:i});e.dispatchEvent(l),e.focus&&e.focus();const c=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,bubbles:!0});if(e.dispatchEvent(c),n){const e=this.calculateTimeSaved("resume-conversation");this.logToPanel(`🔄 Resume Conversation clicked [saved ${this.formatTimeDuration(e)}]`,"info"),this.log(`Resume Conversation clicked - Time saved: ${this.formatTimeDuration(e)}`),this.analytics.buttonTypeCounts||(this.analytics.buttonTypeCounts={}),this.analytics.buttonTypeCounts["resume-conversation"]=(this.analytics.buttonTypeCounts["resume-conversation"]||0)+1,this.analytics.totalAccepts++,this.roiTracking.totalTimeSaved+=e,this.saveToStorage()}else if(a)this.trackFileAcceptance(a,t);else{const n=this.calculateTimeSaved(t);this.logToPanel(`✓ Clicked: ${e.textContent.trim()} [saved ${this.formatTimeDuration(n)}]`,"info");const a=this.normalizeButtonType(t);this.analytics.buttonTypeCounts||(this.analytics.buttonTypeCounts={}),this.analytics.buttonTypeCounts[a]=(this.analytics.buttonTypeCounts[a]||0)+1,this.analytics.totalAccepts++,this.roiTracking.totalTimeSaved+=n,this.saveToStorage()}return this.updatePanelStatus(),"analytics"!==this.currentTab&&"roi"!==this.currentTab||this.updateAnalyticsContent(),this.updateMainFooter(),!0}catch(e){return this.logToPanel(`Failed to click: ${e.message}`,"warning"),this.debugMode&&this.log(`DEBUG: Click error stack: ${e.stack}`),!1}}checkAndClick(){try{const e=this.findAcceptButtons();if(0===e.length)return;const t=e[0];t.textContent.trim().substring(0,30);this.clickElement(t)&&(this.totalClicks++,this.updatePanelStatus())}catch(e){this.log(`Error executing: ${e.message}`)}}start(){this.isRunning?this.logToPanel("Already running","warning"):(this.isRunning=!0,this.totalClicks=0,this.updatePanelStatus(),this.checkAndClick(),this.monitorInterval=setInterval((()=>{this.checkAndClick()}),this.interval),this.logToPanel(`Started (${this.interval/1e3}s interval)`,"info"))}stop(){this.isRunning?(clearInterval(this.monitorInterval),this.isRunning=!1,this.updatePanelStatus(),this.logToPanel(`Stopped (${this.totalClicks} clicks)`,"info")):this.logToPanel("Not running","warning")}status(){return{isRunning:this.isRunning,interval:this.interval,totalClicks:this.totalClicks,config:this.config}}enableOnly(e){Object.keys(this.config).forEach((e=>{this.config[e]=!1})),e.forEach((e=>{const t=`enable${e.charAt(0).toUpperCase()+e.slice(1)}`;this.config.hasOwnProperty(t)&&(this.config[t]=!0,this.log(`Enabled ${e} buttons`))})),this.log(`Configuration updated: Only ${e.join(", ")} buttons enabled`)}enableAll(){Object.keys(this.config).forEach((e=>{this.config[e]=!0})),this.log("All button types enabled")}disableAll(){Object.keys(this.config).forEach((e=>{this.config[e]=!1})),this.log("All button types disabled")}toggle(e){const t=`enable${e.charAt(0).toUpperCase()+e.slice(1)}`;this.config.hasOwnProperty(t)?(this.config[t]=!this.config[t],this.log(`${e} buttons ${this.config[t]?"enabled":"disabled"}`)):this.log(`Unknown button type: ${e}`)}enable(e){const t=`enable${e.charAt(0).toUpperCase()+e.slice(1)}`;this.config.hasOwnProperty(t)?(this.config[t]=!0,this.log(`${e} buttons enabled`)):this.log(`Unknown button type: ${e}`)}disable(e){const t=`enable${e.charAt(0).toUpperCase()+e.slice(1)}`;this.config.hasOwnProperty(t)?(this.config[t]=!1,this.log(`${e} buttons disabled`)):this.log(`Unknown button type: ${e}`)}debugSearch(){this.log("=== DEBUG SEARCH ===");const e=document.querySelector("div.full-input-box");if(!e)return void this.log("No input box found");this.log("Input box found, checking siblings...");let t=e.previousElementSibling,n=1;for(;t&&n<=10;){this.log(`Sibling ${n}: ${t.tagName} ${t.className}`);const e=t.textContent?t.textContent.trim():"";if(e){this.log(`  Text: "${e.substring(0,100)}"`);const t=["accept","run","execute","apply"].filter((t=>e.toLowerCase().includes(t)));t.length>0&&this.log(`  >>> Contains patterns: ${t.join(", ")}`)}const a=this.findAcceptInElement(t);a.length>0&&(this.log(`  Found ${a.length} clickable buttons!`),a.forEach(((e,t)=>{this.log(`    Button ${t+1}: "${e.textContent.trim().substring(0,50)}"`)}))),t=t.previousElementSibling,n++}this.log("=== END DEBUG ===")}findResumeLinks(){const e=[],t=['.markdown-link[data-link="command:composer.resumeCurrentChat"]','.markdown-link[data-link*="resume"]','span.markdown-link[data-link="command:composer.resumeCurrentChat"]'];for(const n of t){const t=document.querySelectorAll(n);for(const n of t)this.isResumeLink(n)&&e.push(n)}return e}isResumeLink(e){if(!e)return!1;const t="command:composer.resumeCurrentChat"===e.getAttribute("data-link"),n=e.textContent&&e.textContent.toLowerCase().includes("resume");e.classList.contains("markdown-link");if(!t&&!n)return!1;const a=this.isElementVisible(e),o=this.isElementClickable(e);return a&&o}findDiffBlocks(){const e=[],t=["div.composer-diff-block","div.composer-code-block-container","div.composer-tool-former-message"];for(const n of t){const t=document.querySelectorAll(n);for(const n of t){const t=this.analyzeDiffBlock(n);t&&e.push(t)}}return e}analyzeDiffBlock(e){try{if(!e)return null;const t={blockElement:e,timestamp:new Date,files:[],changeType:"unknown"},n=e.querySelector(".composer-code-block-header");if(n){const e=this.extractFileInfoFromHeader(n);e&&t.files.push(e)}const a=e.querySelector(".composer-code-block-filename span");if(a&&!t.files.length){const e=a.textContent.trim();e&&t.files.push({name:e,path:e,extension:this.getFileExtension(e)})}const o=e.querySelector('.composer-code-block-status span[style*="color"]');if(o){const e=o.textContent.trim();e.includes("+")?(t.changeType="addition",t.linesAdded=this.extractNumber(e)):e.includes("-")&&(t.changeType="deletion",t.linesDeleted=this.extractNumber(e))}const s=e.querySelectorAll('.composer-code-block-status span[style*="color"]');let i=!1,l=!1;return s.forEach((e=>{const n=e.textContent.trim();n.includes("+")?(i=!0,t.linesAdded=this.extractNumber(n)):n.includes("-")&&(l=!0,t.linesDeleted=this.extractNumber(n))})),i&&l?t.changeType="modification":i?t.changeType="addition":l&&(t.changeType="deletion"),t.files.length>0?t:null}catch(e){return this.log(`Error analyzing diff block: ${e.message}`),null}}extractFileInfoFromHeader(e){try{const t=e.querySelector(".composer-code-block-file-info");if(!t)return null;const n=t.querySelector(".composer-code-block-filename span"),a=n?n.textContent.trim():null;return a?{name:a,path:a,extension:this.getFileExtension(a),hasIcon:!!t.querySelector(".composer-code-block-file-icon")}:null}catch(e){return this.log(`Error extracting file info from header: ${e.message}`),null}}getFileExtension(e){if(!e||"string"!=typeof e)return"";const t=e.lastIndexOf(".");return t>0?e.substring(t+1).toLowerCase():""}extractNumber(e){if(!e)return 0;const t=e.match(/[+-]?(\d+)/);return t?parseInt(t[1],10):0}findRecentDiffBlocks(e=3e4){const t=this.findDiffBlocks(),n=Date.now()-e;return t.filter((e=>e.timestamp&&e.timestamp.getTime()>n))}getConversationContext(){const e=document.querySelector("div.conversations");if(!e)return this.log("Conversation container not found"),null;const t={conversationElement:e,totalMessages:0,recentDiffs:[],filesChanged:new Set,lastActivity:null},n=e.querySelectorAll("[data-message-index]");t.totalMessages=n.length;const a=this.findRecentDiffBlocks();if(t.recentDiffs=a,a.forEach((e=>{e.files.forEach((e=>{t.filesChanged.add(e.name)}))})),t.filesChanged=Array.from(t.filesChanged),n.length>0){n[n.length-1];t.lastActivity=new Date}return t}logConversationActivity(){const e=this.getConversationContext();e&&(this.log("=== CONVERSATION ACTIVITY ==="),this.log(`Total messages: ${e.totalMessages}`),this.log(`Recent diffs: ${e.recentDiffs.length}`),this.log(`Files changed: ${e.filesChanged.length}`),e.filesChanged.length>0&&this.log(`Changed files: ${e.filesChanged.join(", ")}`),e.recentDiffs.forEach(((e,t)=>{this.log(`Diff ${t+1}: ${e.changeType} - ${e.files.map((e=>e.name)).join(", ")}`),e.linesAdded&&this.log(`  +${e.linesAdded} lines added`),e.linesDeleted&&this.log(`  -${e.linesDeleted} lines deleted`)})),this.log("=== END CONVERSATION ACTIVITY ==="))}}globalThis.autoAcceptAndAnalytics=e}if(!globalThis.simpleAccept){globalThis.simpleAccept=new globalThis.autoAcceptAndAnalytics(2e3),globalThis.startAccept=()=>globalThis.simpleAccept.start(),globalThis.stopAccept=()=>globalThis.simpleAccept.stop(),globalThis.acceptStatus=()=>globalThis.simpleAccept.status(),globalThis.debugAccept=()=>globalThis.simpleAccept.debugSearch(),globalThis.testLogs=()=>(console.log("TEST LOG 1 - console.log"),console.info("TEST LOG 2 - console.info"),console.warn("TEST LOG 3 - console.warn"),console.error("TEST LOG 4 - console.error"),alert("TEST: Console logging test completed. Check console above."),"Logging test completed"),globalThis.enableOnly=e=>globalThis.simpleAccept.enableOnly(e),globalThis.enableAll=()=>globalThis.simpleAccept.enableAll(),globalThis.disableAll=()=>globalThis.simpleAccept.disableAll(),globalThis.toggleButton=e=>globalThis.simpleAccept.toggle(e),globalThis.enableButton=e=>globalThis.simpleAccept.enable(e),globalThis.disableButton=e=>globalThis.simpleAccept.disable(e),globalThis.exportAnalytics=()=>globalThis.simpleAccept.exportAnalytics(),globalThis.clearAnalytics=()=>globalThis.simpleAccept.clearAnalytics(),globalThis.clearStorage=()=>globalThis.simpleAccept.clearStorage(),globalThis.validateData=()=>globalThis.simpleAccept.validateData(),globalThis.toggleDebug=()=>globalThis.simpleAccept.toggleDebug(),globalThis.calibrateWorkflow=(e,t)=>globalThis.simpleAccept.calibrateWorkflowTimes(e,t),globalThis.showAnalytics=()=>{globalThis.simpleAccept.switchTab("analytics"),console.log("Analytics tab opened in control panel")},globalThis.findDiffs=()=>globalThis.simpleAccept.findDiffBlocks(),globalThis.getContext=()=>globalThis.simpleAccept.getConversationContext(),globalThis.logActivity=()=>globalThis.simpleAccept.logConversationActivity(),globalThis.recentDiffs=e=>globalThis.simpleAccept.findRecentDiffBlocks(e),globalThis.enableDebug=()=>{globalThis.simpleAccept.debugMode=!0,console.log("Debug mode enabled - file extraction logging activated")},globalThis.disableDebug=()=>{globalThis.simpleAccept.debugMode=!1,console.log("Debug mode disabled")};const e="[autoAcceptAndAnalytics] SCRIPT LOADED AND ACTIVE!";console.log(e),console.info(e),console.warn(e);try{const e=document.createElement("div");e.textContent="✅ AutoAccept Control Panel Ready! Now with File Analytics - Click Analytics tab!",e.style.cssText="position:fixed;top:10px;left:50%;transform:translateX(-50%);background:#4CAF50;color:white;padding:10px 20px;border-radius:5px;z-index:99999;font-weight:bold;max-width:400px;text-align:center;",document.body.appendChild(e),setTimeout((()=>e.remove()),4e3)}catch(e){}console.log("Commands: startAccept(), stopAccept(), acceptStatus(), debugAccept()"),console.log("Analytics: showAnalytics(), exportAnalytics(), clearAnalytics(), clearStorage(), validateData()"),console.log("Debug: toggleDebug(), enableDebug(), disableDebug() - Control debug logging"),console.log("Calibration: calibrateWorkflow(manualSeconds, autoMs) - Adjust workflow timing"),console.log("Config: enableOnly([types]), enableAll(), disableAll(), toggleButton(type)"),console.log("Conversation: findDiffs(), getContext(), logActivity(), recentDiffs(maxAge)"),console.log('Types: "acceptAll", "accept", "run", "runCommand", "apply", "execute", "resume"')}}();